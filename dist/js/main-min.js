!function(e){e(document).ready(function(){function i(){var i=e("#bgcolor").val().split(",");p={r:i[0],g:i[1],b:i[2]}}function t(){g=e("#main-icon").val();var t=e("#main-icon option:selected").data("color");t&&t.length>0&&(e("#bgcolor").val(t),i())}function n(){u=e("#title").val()}function l(e){var i=x[e].subTitle.size,t=x[e].size.width,n=x[e].size.height,l=x[e].size.padding;return!(!z||0==z.length)&&s(i,t/2+i/2,n-l-i/2)}function o(e){var i=x[e].title.size,t=x[e].size.width,n=x[e].size.height,l=x[e].size.padding,o=x[e].subTitle.size,a=s(i,t/2+i/2,n-l-i/2);return z&&0!=z.length&&(a.y-=o*v),a}function a(e){var i=x[e].size.width,t=x[e].size.height,n=x[e].size.padding,l=x[e].title.size,o=x[e].subTitle.size,a=x[e].subIcon.power,h=t-n,c=i-n;1.618*t<i&&(c=1.618*t),z&&0!=z.length&&(h-=o),u&&0!=u.length&&(h-=l*v),(u&&0!=u.length||z&&0!=z.length)&&(h-=n/2,c=i/2+t/2-n);var r=(h-n)*a,g=c-r/2,d=h-r/2,f=s(r,g,d);return{x:f.x,y:f.y,size:r,centerX:g,centerY:d}}function h(e){var i=x[e].size.width,t=x[e].size.height,n=x[e].size.padding,l=x[e].title.size,o=x[e].subTitle.size,a=x[e].withSub,h=n,c=t-n-n,r=n;i-1.618*t>0&&(r=i-1.618*t),z&&0!=z.length&&(c-=o),u&&0!=u.length&&(c-=l*v),(u&&0!=u.length||z&&0!=z.length)&&(c-=n/2,r=i/2-t/2+n),d&&"none"!=d&&(c*=a);var g=r+c/2;d&&"none"!=d||(g=i/2);var f=s(c,g,h+c/2);return{x:f.x,y:f.y,size:c}}function s(e,i,t){return{x:Math.round(i-e/2),y:Math.round(t+.87*e/2)}}function c(){!function(){for(var e=x.length-1;e>=0;e--){x[e].ctx.clearRect(0,0,x[e].size.width,x[e].size.height)}}(),function(){for(var e=x.length-1;e>=0;e--){var i=x[e].ctx;i.fillStyle="rgb("+p.r+", "+p.g+", "+p.b+")",x[e].type&&"icon"==x[e].type?(console.log(x[e].type),i.beginPath(),i.arc(x[e].size.width/2,x[e].size.height/2,Math.round(x[e].size.width/2)-1,0,2*Math.PI,!0),i.fill()):i.fillRect(0,0,x[e].size.width,x[e].size.height)}}(),function(){for(var i=x.length-1;i>=0;i--){var t=x[i].ctx;t.textAlign="start",t.fillStyle="rgb(256, 256, 256)";x[i].size.width,x[i].size.padding;var n=x[i].size.height-2*x[i].size.padding;if(x[i].type&&"icon"==x[i].type){var l=2*Math.round(.8*n*.5)-1,o=s(l,x[i].size.width/2,x[i].size.height/2);t.font=l+"px '"+f+"'",t.fillText(g,.9*o.x,o.y);var a=document.getElementById("canvas-32x32").toDataURL("image/png").replace("data:image/png;base64,","");console.log(a),e("#base64").val(a)}else{o=h(i);t.font=o.size+"px '"+f+"'",t.fillStyle="rgb(256, 256, 256)",t.fillText(g,o.x,o.y)}}}(),function(){for(var e=x.length-1;e>=0;e--){var i=x[e].ctx;x[e].size.width,x[e].size.padding,x[e].size.height,x[e].size.padding;if(x[e].type&&"icon"==x[e].type);else if(d&&"none"!=d){var t=a(e);i.font=t.size+"px '"+f+"'",i.textAlign="start",i.fillStyle="rgb("+p.r+", "+p.g+", "+p.b+")";for(var n=0;n<360;n+=10){var l=Math.PI/180*n,o=Math.cos(l)*t.size*.075,h=Math.sin(l)*t.size*.075;console.log(o,h),i.fillText(d,t.x+o,t.y+h)}i.fillStyle="rgb(256, 256, 256)",i.fillText(d,t.x,t.y)}}}(),function(){for(var e=x.length-1;e>=0;e--)if(x[e].type&&"icon"==x[e].type);else{var i=x[e].ctx;if(u&&0!=u.length){i.font=x[e].title.size+"px 'noto-b'",i.fillStyle="rgb(256, 256, 256)",i.textAlign="center";var t=o(e);i.fillText(u,t.x,t.y)}}}(),r()}function r(){for(var e=x.length-1;e>=0;e--)if(x[e].type&&"icon"==x[e].type);else{var i=x[e].ctx;if(z&&0!=z.length){i.font=x[e].subTitle.size+"px 'noto'",i.fillStyle="rgb(256, 256, 256)",i.textAlign="center";var t=l(e);i.fillText(z,t.x,t.y)}}}console.log("ready");for(var g,d,u,z,f="Questetra-Icon-Font-A",v=1.5,p={},x=[{id:"canvas-1200x630",ctx:null,size:{width:1200,height:630,padding:60},viewSize:{width:300,height:157.5},withSub:1,title:{size:64},subTitle:{size:46},subIcon:{power:.5}},{id:"canvas-600x315",ctx:null,size:{width:600,height:315,padding:30},viewSize:{width:300,height:157.5},withSub:1,title:{size:32},subTitle:{size:24},subIcon:{power:.5}},{id:"canvas-220x220",ctx:null,size:{width:220,height:220,padding:20},viewSize:{width:220,height:220},withSub:.9,title:{size:18},subTitle:{size:12},subIcon:{power:.5}},{id:"canvas-32x32",ctx:null,size:{width:32,height:32,padding:3},viewSize:{width:32,height:32},type:"icon",title:{size:0}}],b=0;b<icons.length;b++){var w=icons[b];e(".icon-selector").each(function(i,t){e(this).append('<option value="'+w.value+'" data-color="'+w.color+'">'+w.label+"</option>")})}e("#main-icon option:eq(0)").attr("selected",!0);for(b=x.length-1;b>=0;b--){console.log(x[b]);var y=document.getElementById(x[b].id).getContext("2d");x[b].ctx=y,e("#"+x[b].id).css({width:x[b].viewSize.width,height:x[b].viewSize.height})}e("#bgcolor").change(function(e){i(),c()}),e("#main-icon").change(function(e){t(),c()}),e("#sub-icon").change(function(i){d=e("#sub-icon").val(),c()}),e("#title").change(function(e){n(),c()}),e("#sub-title").change(function(i){z=e("#sub-title").val(),c()}),i(),t(),n(),r(),c()})}(window.jQuery);