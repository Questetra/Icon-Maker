!function(i){i(document).ready(function(){function e(){var e=i("#bgcolor").val().split(",");A={r:e[0],g:e[1],b:e[2]}}function t(){T=i("#main-icon").val();var t=i("#main-icon option:selected").data("color");t&&t.length>0&&(i("#bgcolor").val(t),e())}function n(){I=i("#sub-icon").val()}function l(){M=i("#title").val()}function o(){m=i("#sub-title").val()}function s(){g(),u(),f(),z(),v()}function h(i){var e=b[i].subTitle.size,t=b[i].size.width,n=b[i].size.height,l=b[i].size.padding;return!(!m||0==m.length)&&d(e,t/2+e/2,n-l-e/2)}function a(i){var e=b[i].title.size,t=b[i].size.width,n=b[i].size.height,l=b[i].size.padding,o=b[i].subTitle.size,s=d(e,t/2+e/2,n-l-e/2);return m&&0!=m.length&&(s.y-=o*p),s}function c(i){var e=b[i].size.width,t=b[i].size.height,n=b[i].size.padding,l=b[i].title.size,o=b[i].subTitle.size,s=b[i].subIcon.power,h=t-n,a=e-n;1.618*t<e&&(a=1.618*t),m&&0!=m.length&&(h-=o),M&&0!=M.length&&(h-=l*p),(M&&0!=M.length||m&&0!=m.length)&&(h-=n/2,a=e/2+t/2-n);var c=(h-n)*s,r=a-c/2,g=h-c/2,u=d(c,r,g);return{x:u.x,y:u.y,size:c,centerX:r,centerY:g}}function r(i){var e=b[i].size.width,t=b[i].size.height,n=b[i].size.padding,l=b[i].title.size,o=b[i].subTitle.size,s=b[i].withSub,h=n,a=t-n-n,c=n;e-1.618*t>0&&(c=e-1.618*t),m&&0!=m.length&&(a-=o),M&&0!=M.length&&(a-=l*p),(M&&0!=M.length||m&&0!=m.length)&&(a-=n/2,c=e/2-t/2+n),I&&"none"!=I&&(a*=s);var r=c+a/2;I&&"none"!=I||(r=e/2);var g=d(a,r,h+a/2);return{x:g.x,y:g.y,size:a}}function g(){for(var i=b.length-1;i>=0;i--){var e=b[i].ctx;e.fillStyle="rgb("+A.r+", "+A.g+", "+A.b+")",b[i].type&&"icon"==b[i].type?(console.log(b[i].type),e.beginPath(),e.arc(b[i].size.width/2,b[i].size.height/2,Math.round(b[i].size.width/2)-1,0,2*Math.PI,!0),e.fill()):e.fillRect(0,0,b[i].size.width,b[i].size.height)}}function d(i,e,t){return{x:Math.round(e-i/2),y:Math.round(t+.87*i/2)}}function u(){for(var i=b.length-1;i>=0;i--){var e=b[i].ctx;e.textAlign="start",e.fillStyle="rgb(256, 256, 256)";b[i].size.width,b[i].size.padding;var t=b[i].size.height-2*b[i].size.padding;if(b[i].type&&"icon"==b[i].type){var n=2*Math.round(.8*t*.5)-1,l=d(n,b[i].size.width/2,b[i].size.height/2);e.font=n+"px '"+x+"'",e.fillText(T,.9*l.x,l.y)}else{l=r(i);e.font=l.size+"px '"+x+"'",e.fillStyle="rgb(256, 256, 256)",e.fillText(T,l.x,l.y)}}}function f(){for(var i=b.length-1;i>=0;i--){var e=b[i].ctx;b[i].size.width,b[i].size.padding,b[i].size.height,b[i].size.padding;if(b[i].type&&"icon"==b[i].type);else if(I&&"none"!=I){var t=c(i);e.font=t.size+"px '"+x+"'",e.textAlign="start",e.fillStyle="rgb("+A.r+", "+A.g+", "+A.b+")";for(var n=0;n<360;n+=10){var l=Math.PI/180*n,o=Math.cos(l)*t.size*.075,s=Math.sin(l)*t.size*.075;console.log(o,s),e.fillText(I,t.x+o,t.y+s)}e.fillStyle="rgb(256, 256, 256)",e.fillText(I,t.x,t.y)}}}function z(){for(var i=b.length-1;i>=0;i--)if(b[i].type&&"icon"==b[i].type);else{var e=b[i].ctx;if(M&&0!=M.length){e.font="bold "+b[i].title.size+"px 'arial, helvetica, clean, sans-serif'",e.fillStyle="rgb(256, 256, 256)",e.textAlign="center";var t=a(i);e.fillText(M,t.x,t.y)}}}function v(){for(var i=b.length-1;i>=0;i--)if(b[i].type&&"icon"==b[i].type);else{var e=b[i].ctx;if(m&&0!=m.length){e.font=b[i].subTitle.size+"px 'arial, helvetica, clean, sans-serif'",e.fillStyle="rgb(256, 256, 256)",e.textAlign="center";var t=h(i);e.fillText(m,t.x,t.y)}}}console.log("ready");for(var x="Questetra-Icon-Font-A",p=1.5,b=[{id:"canvas-1200x630",ctx:null,size:{width:1200,height:630,padding:60},viewSize:{width:300,height:157.5},withSub:1,title:{size:64},subTitle:{size:46},subIcon:{power:.5}},{id:"canvas-600x315",ctx:null,size:{width:600,height:315,padding:30},viewSize:{width:300,height:157.5},withSub:1,title:{size:32},subTitle:{size:24},subIcon:{power:.5}},{id:"canvas-220x220",ctx:null,size:{width:220,height:220,padding:20},viewSize:{width:220,height:220},withSub:.9,title:{size:18},subTitle:{size:12},subIcon:{power:.5}},{id:"canvas-32x32",ctx:null,size:{width:32,height:32,padding:3},viewSize:{width:32,height:32},type:"icon",title:{size:0}}],w=0;w<icons.length;w++){var y=icons[w];console.log(y),i(".icon-selector").each(function(e,t){i(this).append('<option value="'+y.value+'" data-color="'+y.color+'">'+y.label+"</option>")})}for(w=b.length-1;w>=0;w--){console.log(b[w]);var S=document.getElementById(b[w].id).getContext("2d");console.log(S),console.log(b[w].ctx),b[w].ctx=S,i("#"+b[w].id).css({width:b[w].viewSize.width,height:b[w].viewSize.height})}var T,I,M,m,A={};i("#bgcolor").change(function(i){e(),s()}),i("#main-icon").change(function(i){t(),s()}),i("#sub-icon").change(function(i){n(),s()}),i("#title").change(function(i){l(),s()}),i("#sub-title").change(function(i){o(),s()}),e(),t(),l(),v(),s()})}(window.jQuery);